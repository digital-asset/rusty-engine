-- Copyright (c) 2019 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0
daml 1.2
module Sort where

import DA.Assert

insert : Int -> [Int] -> [Int]
insert y = \case
  [] -> [y]
  x :: xs
    | y <= x -> y :: x :: xs
    | otherwise -> x :: insert y xs

isort : [Int] -> [Int]
isort = \case
  [] -> []
  x :: xs -> insert x (isort xs)

sorted : [Int] -> Bool
sorted = \case
  [] -> True
  [_] -> True
  x1 :: x2 :: xs -> x1 <= x2 && sorted (x2 :: xs)

test = scenario do
  let xs = [4,1,6,2,8,3,9,0,5,7]
  isort xs === [0..9]
